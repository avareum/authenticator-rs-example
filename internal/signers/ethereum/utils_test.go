package ethereum

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func Test_MethodSignature(t *testing.T) {
	assert := assert.New(t)

	t.Run("should extract method signature", func(t *testing.T) {
		bytecode := "0x5ae401dc0000000000000000000000000000000000000000000000000000000062f24252000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000e4472b43f3000000000000000000000000000000000000000000000000000356ecce16c000000000000000000000000000000000000000000000000000003c55123e6c3bb000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000057e590ca949de0f537a48b3ff415fb46f52c48ab000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004449404b7c000000000000000000000000000000000000000000000000003c55123e6c3bb000000000000000000000000077699b6ec690df8a449718df3cfaa51bc411dc4100000000000000000000000000000000000000000000000000000000"
		sig, err := MethodSignature(bytecode)
		assert.Nil(err)
		assert.Equal("5ae401dc", sig)
	})

	t.Run("should reject invalid bytecode", func(t *testing.T) {
		bytecode := "0x1"
		_, err := MethodSignature(bytecode)
		assert.EqualError(err, "invalid bytecode")
	})
}
